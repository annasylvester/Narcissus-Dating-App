<!DOCTYPE html>
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Narcissus</title>

  <!-- Materialize CSS and JS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <!-- JQuery -->
  <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>
  <!-- My Style Sheet -->
  <link href="./style.css" type="text/css" rel="stylesheet" />
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet">


</head>

<body>

  <div class="row">
    <div class="col s0 m1 l2"></div>
    <div class="col s12 m10 l8">

      <div class="container" style="background-color: white; padding: 5%; margin-top: 75px; border: solid; border-color: lightblue; border-width: 5px;">

        <!-- Header -->
        <div class="center-align">
          <h2 style="font-family: 'Roboto Condensed', sans-serif; padding-bottom: 5%; color: navy;">SURVEY</h2>
        </div>

        <!-- Name Input -->
        <div class="row">
          <div class="col s12">
            <div class="input-field col s6">
              <input id="name" type="text" class="form-control">
              <label for="name">First Name</label>
            </div>
          </div>
        </div>

        <!-- Upload photo -->
        <div class="row">
          <div class="col s12">
            <form action="#">
              <div class="file-field input-field">
                <div class="btn" style="background-color: pink;">
                  <span>Upload Photo</span>
                  <input type="file" class="form-control" id="photo">
                </div>
                <div class="file-path-wrapper">
                  <input class="file-path validate" type="text">
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- Survey Questions -->
        <div class="row">
          <div class="col s12">
            <h4 style="font-size: 14pt; color: gray;">Q1. How much do you love yourself?</h4>
            <select class="browser-default chosen-select" id="q1">
              <option value="" disabled selected>Choose your answer</option>
              <option value="1">1 -- Not at all</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 -- I'm a gift to the world</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col s12">
            <h4 style="font-size: 14pt; color: gray;">Q2. Do you follow your head, heart or somewhere inbetween?</h4>
            <select class="browser-default chosen-select" id="q2">
              <option value="" disabled selected>Choose your answer</option>
              <option value="1">1 -- Head</option>
              <option value="2">2</option>
              <option value="3">3 -- Half and half</option>
              <option value="4">4</option>
              <option value="5">5 -- Heart</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col s12">
            <h4 style="font-size: 14pt; color: gray;">Q3. Are you always right?</h4>
            <select class="browser-default chosen-select" id="q3">
              <option value="" disabled selected>Choose your answer</option>
              <option value="1">1 -- Not even close</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 -- 100%. And I'm right about this too</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col s12">
            <h4 style="font-size: 14pt; color: gray;">Q4. Do you find it easy to stay focused under pressure?</h4>
            <select class="browser-default chosen-select" id="q4">
              <option value="" disabled selected>Choose your answer</option>
              <option value="1">1 -- No way. I get frazzeled easily</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 -- Pressure? Bring it on</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col s12">
            <h4 style="font-size: 14pt; color: gray;">Q5. Do other people easily upset you?</h4>
            <select class="browser-default chosen-select" id="q5">
              <option value="" disabled selected>Choose your answer</option>
              <option value="1">1 -- No. We're all human</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 -- Yes. Other people are annoying</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col s12">
            <h4 style="font-size: 14pt; color: gray;">Q6. Do you think everyone’s views should be respected regardless
              of whether they are supported by facts or not?</h4>
            <select class="browser-default chosen-select" id="q6">
              <option value="" disabled selected>Choose your answer</option>
              <option value="1">1 -- Yes, of course. Feelings are valid</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 -- Not at all. Only facts matter</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col s12">
            <h4 style="font-size: 14pt; color: gray;">Q7. Do you feel more energetic after spending time with a group
              of people?</h4>
            <select class="browser-default chosen-select" id="q7">
              <option value="" disabled selected>Choose your answer</option>
              <option value="1">1 -- No. I'm a total introvert</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 -- Yes. I'm a total extrovert</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col s12">
            <h4 style="font-size: 14pt; color: gray;">Q8. Is it easy for you to relate to other peoples feelings?</h4>
            <select class="browser-default chosen-select" id="q8">
              <option value="" disabled selected>Choose your answer</option>
              <option value="1">1 -- Yes, totally</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 -- No. I don't get other people</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col s12">
            <h4 style="font-size: 14pt; color: gray;">Q9. Do you see yourself as dependable and self disciplined?</h4>
            <select class="browser-default chosen-select" id="q9">
              <option value="" disabled selected>Choose your answer</option>
              <option value="1">1 -- No way</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 -- Yes</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="col s12">
            <h4 style="font-size: 14pt; color: gray;">Q10. Do you get carried away by fantasies and ideas?</h4>
            <select class="browser-default chosen-select" id="q10">
              <option value="" disabled selected>Choose your answer</option>
              <option value="1">1 -- What can I say, I'm a dreamer</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 -- None of that for me</option>
            </select>
          </div>
        </div>

        <!-- Submit Button -->
        <div class="container">
          <div class="center-align">
            <button type="submit" class="btn btn-primary btn-lg btn-block" style="background-color: pink; " id="submit">
              <i class="fa fa-check-circle" aria-hidden="true">Submit</i>
            </button>
          </div>
        </div>

      </div>
      <div class="col s0 m1 l2"></div>

      <!-- Footer -->
      <footer class="footer">
        <div class="container">
          <div class="center-align">
            <p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/annasylvester/Narcissus-Dating-App">GitHub
                Repo</a></p>
          </div>
        </div>
      </footer>
    </div>


    <!-- Modal Trigger -->
  <a class="waves-effect waves-light btn modal-trigger" href="#modal1">Modal</a>

  <!-- Modal Structure -->
  <div id="modal1" class="modal">
    <div class="modal-content">
      <h4>Modal Header</h4>
      <p>A bunch of text</p>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-green btn-flat">Agree</a>
    </div>
  </div>
          

    <!-- Modal Pop Up -->
    <div id="results-modal" class="modal fade" role="dialog">
      <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">×</button>
            <h2 class="modal-title"><strong>Best Match</strong></h2>
          </div>
          <div class="modal-body">
            <h2 id="match-name"></h2>
            <img id="match-img" height="200" alt="https://static.pexels.com/photos/20787/pexels-photo.jpg">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>


  <script>
    $(document).ready(function () {
      $('select').formSelect();
    });
  </script>


  <script type="text/javascript">
    $("#submit").on("click", function (event) {
      event.preventDefault();

      function validate() {
        var isValid = true;
        $(".form-control").each(function () {
          if ($(this).val() === "" || $(this).val() === null) {
            isValid = false;
          }
        });
        $(".chosen-select").each(function () {
          if ($(this).val() === null || $(this).val() === "") {
            isValid = false;
          }
        })
        return isValid;
      }

      //if data is valid then will post it
      if (validate()) {
        var score = [$("#q1").val().trim(), $("#q2").val().trim(), $("#q3").val().trim(), $("#q4").val().trim(),
          $(
            "#q5").val().trim(), $("#q6").val().trim(), $("#q7").val().trim(), $("#q8").val().trim(), $("#q9").val()
          .trim(), $("#q10").val().trim()
        ];
        var newFriend = {
          name: $("#name").val(),
          photo: $("#photo").val(),
          scores: score
        };
        console.log(newFriend);
        $.ajax({
          type: 'POST',
          data: newFriend,
          url: "/api/matches",
          success: function (res) {
            console.log(res);
            alert("Info added!");
            $("#match-name").text(res.name);
            $("#match-img").attr("src", res.photo);
            $("#results-modal").modal("toggle"); //this apparently turns on the modal
          }

        })
      } else {
        alert("Form not correctly filled out!");
      }
    });
  </script>

</body>